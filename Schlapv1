-- Load WindUI
local Version = "1.6.31"
local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/download/" .. Version .. "/main.lua"))()

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local Humanoid = Character:WaitForChild("Humanoid")
local Backpack = LocalPlayer:WaitForChild("Backpack")

-- Variables
local WalkSpeedValue, JumpPowerValue = 16, 50
local AutoSlapEnabled = false
local SpinBotEnabled = false
local SpeedEnabled = false

-- Create Window
local Window = WindUI:CreateWindow({
	Title = "Schlap",
	Icon = "rbxassetid://4483345998",
	Author = "Merqury Hub",
	Folder = "SchlapConfig",
	Size = UDim2.fromOffset(580, 460),
	KeySystem = {
		Key = "SchlapKey2025",
		Note = "Join our Discord for the key!",
		URL = "https://discord.gg/example",
		SaveKey = true
	},
	Transparent = true,
	Theme = "Dark",
	SideBarWidth = 170
})

-- === MAIN TAB ===
local mainTab = Window:Tab({
	Title = "Main",
	Icon = "hand"
})

mainTab:Toggle({
	Title = "Auto Slap",
	Default = false,
	Callback = function(state)
		AutoSlapEnabled = state
	end
})

-- === MISC TAB ===
local miscTab = Window:Tab({
	Title = "Misc",
	Icon = "settings"
})

miscTab:Button({
	Title = "Rejoin",
	Callback = function()
		game:GetService("TeleportService"):TeleportToPlaceInstance(game.PlaceId, game.JobId, LocalPlayer)
	end
})

miscTab:Slider({
	Title = "WalkSpeed",
	Default = WalkSpeedValue,
	Min = 16,
	Max = 500,
	Callback = function(value)
		WalkSpeedValue = value
		if Humanoid then Humanoid.WalkSpeed = value end
	end
})

miscTab:Slider({
	Title = "JumpPower",
	Default = JumpPowerValue,
	Min = 50,
	Max = 500,
	Callback = function(value)
		JumpPowerValue = value
		if Humanoid then Humanoid.JumpPower = value end
	end
})

miscTab:Button({
	Title = "Server Hop",
	Callback = function()
		local HttpService = game:GetService("HttpService")
		local TeleportService = game:GetService("TeleportService")
		local PlaceId = game.PlaceId
		local Servers = {}
		local Success, Response = pcall(function()
			return game:HttpGet("https://games.roblox.com/v1/games/"..PlaceId.."/servers/Public?sortOrder=Asc&limit=100")
		end)
		if Success then
			local Data = HttpService:JSONDecode(Response)
			for _, server in pairs(Data.data) do
				if server.playing < server.maxPlayers and server.id ~= game.JobId then
					table.insert(Servers, server.id)
				end
			end
			if #Servers > 0 then
				TeleportService:TeleportToPlaceInstance(PlaceId, Servers[math.random(1, #Servers)], LocalPlayer)
			end
		end
	end
})

miscTab:Toggle({
	Title = "Spin Bot",
	Default = false,
	Callback = function(state)
		SpinBotEnabled = state
	end
})

-- === RUN SERVICE UPDATES ===
RunService.RenderStepped:Connect(function()
	-- Auto Slap logic
	if AutoSlapEnabled then
		for _, player in pairs(Players:GetPlayers()) do
			if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
				local distance = (Character.HumanoidRootPart.Position - player.Character.HumanoidRootPart.Position).Magnitude
				if distance <= 10 then
					local tool = Backpack:GetChildren()[math.random(1, #Backpack:GetChildren())]
					if tool and tool:IsA("Tool") then
						tool.Parent = Character
						tool:Activate()
						tool.Parent = Backpack
					end
				end
			end
		end
	end

	-- Spin Bot logic
	if SpinBotEnabled and Character:FindFirstChild("HumanoidRootPart") then
		Character.HumanoidRootPart.CFrame = Character.HumanoidRootPart.CFrame * CFrame.Angles(0, math.rad(15), 0)
	end

	-- WalkSpeed/JumpPower
	if SpeedEnabled and Humanoid then
		Humanoid.WalkSpeed = WalkSpeedValue
		Humanoid.JumpPower = JumpPowerValue
	end
end)
